<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>nicheware.platform.utilities.common.version documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" type="text/css" href="css/tree.css" /></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">cljc-common</span> <span class="project-version">1.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="intro.html"><div class="inner"><span>Introduction</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>nicheware</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>platform</span></div></div></li><li class="depth-3"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utilities</span></div></div></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></div></li><li class="depth-5 branch"><a href="nicheware.platform.utilities.common.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-5 branch"><a href="nicheware.platform.utilities.common.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-5"><a href="nicheware.platform.utilities.common.graphics.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>graphics</span></div></a></li><li class="depth-6 branch"><a href="nicheware.platform.utilities.common.graphics.color.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>color</span></div></a></li><li class="depth-6 branch"><a href="nicheware.platform.utilities.common.graphics.interpolate.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>interpolate</span></div></a></li><li class="depth-6"><a href="nicheware.platform.utilities.common.graphics.line.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>line</span></div></a></li><li class="depth-5 branch"><a href="nicheware.platform.utilities.common.math.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>math</span></div></a></li><li class="depth-5"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></div></li><li class="depth-6"><a href="nicheware.platform.utilities.common.state.migration.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>migration</span></div></a></li><li class="depth-5 current"><a href="nicheware.platform.utilities.common.version.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>version</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-add-version"><div class="inner"><span>add-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-current-version-key"><div class="inner"><span>current-version-key</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-delete-asset-version"><div class="inner"><span>delete-asset-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-delete-version"><div class="inner"><span>delete-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-find-element-with-ref-name"><div class="inner"><span>find-element-with-ref-name</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-find-index"><div class="inner"><span>find-index</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-current"><div class="inner"><span>get-current</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-current-asset"><div class="inner"><span>get-current-asset</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-current-ref"><div class="inner"><span>get-current-ref</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-first-asset-ref"><div class="inner"><span>get-first-asset-ref</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-ordered-versions"><div class="inner"><span>get-ordered-versions</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-get-version"><div class="inner"><span>get-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-make-ref-name-fn"><div class="inner"><span>make-ref-name-fn</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-mutate-version"><div class="inner"><span>mutate-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-remove-unused-versions"><div class="inner"><span>remove-unused-versions</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-rename-versioned-asset"><div class="inner"><span>rename-versioned-asset</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-rename-versions"><div class="inner"><span>rename-versions</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-replace-current"><div class="inner"><span>replace-current</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-replace-element-with-ref-name"><div class="inner"><span>replace-element-with-ref-name</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-set-version"><div class="inner"><span>set-version</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-timestamp-element"><div class="inner"><span>timestamp-element</span></div></a></li><li class="depth-1"><a href="nicheware.platform.utilities.common.version.html#var-version-element"><div class="inner"><span>version-element</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">nicheware.platform.utilities.common.version</h1><div class="doc"><div class="markdown"><p>This namespace provides a set of functions supporting in-memory versioning of a map of assets represented by a clojure map.</p>
<p>There are groups of functions within the version namespace that deal with:</p>
<table>
  <thead>
    <tr>
      <th>Function group</th>
      <th>Functions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>version reference functions</td>
      <td><a href="nicheware.platform.utilities.common.version.html#var-make-ref-name-fn">make-ref-name-fn</a> <a href="nicheware.platform.utilities.common.version.html#var-find-element-with-ref-name">find-element-with-ref-name</a>, <a href="nicheware.platform.utilities.common.version.html#var-get-current-ref">get-current-ref</a>, <a href="nicheware.platform.utilities.common.version.html#var-get-first-asset-ref">get-first-asset-ref</a>, <a href="nicheware.platform.utilities.common.version.html#var-replace-element-with-ref-name">replace-element-with-ref-name</a></td>
    </tr>
    <tr>
      <td>version access functions</td>
      <td><a href="nicheware.platform.utilities.common.version.html#var-get-ordered-versions">get-ordered-versions</a>, <a href="nicheware.platform.utilities.common.version.html#var-find-index">find-index</a>, <a href="nicheware.platform.utilities.common.version.html#var-current-version-key">current-version-key</a>, <a href="nicheware.platform.utilities.common.version.html#var-get-version">get-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-get-current">get-current</a>, <a href="nicheware.platform.utilities.common.version.html#var-get-current-asset">get-current-asset</a></td>
    </tr>
    <tr>
      <td>version update functions</td>
      <td><a href="nicheware.platform.utilities.common.version.html#var-rename-versions">rename-versions</a>, <a href="null">rename-versioned-assets</a>, <a href="nicheware.platform.utilities.common.version.html#var-timestamp-element">timestamp-element</a>, <a href="nicheware.platform.utilities.common.version.html#var-version-element">version-element</a>, <a href="nicheware.platform.utilities.common.version.html#var-add-version">add-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-replace-current">replace-current</a>, <a href="nicheware.platform.utilities.common.version.html#var-set-version">set-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-mutate-version">mutate-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-delete-version">delete-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-delete-asset-version">delete-asset-version</a>, <a href="nicheware.platform.utilities.common.version.html#var-remove-unused-versions">remove-unused-versions</a></td>
    </tr>
  </tbody>
</table>
<p>A collection of versioned assets are assumed to be held in an asset map of the form:</p>
<pre><code class="clojure">{ &lt;asset-key&gt; {:current &lt;modified-time&gt;
              :name &lt;asset-key&gt;
              :versions { &lt;modified-time-1&gt; {&lt;asset-v1&gt; :name &lt;asset-key&gt; :modified-time &lt;modified-time-1&gt; }
                          &lt;modified-time-2&gt; {&lt;asset-v2&gt; :name &lt;asset-key&gt; :modified-time &lt;modified-time-2&gt; }
                        }
             }

 &lt;asset-key-2&gt; ....
}
</code></pre>
<p>Each asset has a unique key (asset-key). The key is used to</p>
<ul>
  <li>access the asset in the top level map of different assets</li>
  <li>usually accessible as the <code>:name</code> attribute in the full versioned asset</li>
  <li>usually accessible as the <code>:name</code> attribute in each of the versions of the asset.</li>
</ul>
<p>Versioning is done by having a current version (<code>:current</code>) which is a key into different versions of the assets. The keys will normally be the time the version was created.</p>
<p>Functions are provided for adding a new version, removing existing versions etc.</p>
<p>In this simple implementation each version is a full copy of the assets state (any Clojure data structure).</p>
<p>It supports moving through past versions (or undo) simply by changing the modified time referenced by <code>:current</code>.</p>
<p>The functions also support the concept of a version reference, which is a vector of the form</p>
<pre><code class="clojure">[ &lt;asset-key&gt; &lt;version-number&gt;]
</code></pre>
<p>This would be used as reference pointer in any Clojure data type to reference a particular version of an asset.</p>
<p><code>version-number</code> is normally just the modified time.</p></div></div><div class="public anchor" id="var-add-version"><h3>add-version</h3><div class="usage"><code>(add-version versioned-asset element)</code></div><div class="doc"><div class="markdown"><p>Adds to the version list, if not already in the list, will append to the end. Becomes the new current version.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key-n&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt; ...}}}</code></li>
  <li>element: New element to add to the list. Will set the <code>:modified-time</code> to be current time if not already set</li>
  <li>returns: versioned-asset with element added as the latest version (i.e. <code>:current</code> updated)</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L245">view source</a></div></div><div class="public anchor" id="var-current-version-key"><h3>current-version-key</h3><div class="usage"><code>(current-version-key assets asset-key)</code></div><div class="doc"><div class="markdown"><p>Gets the current version key for the specified asset</p>
<ul>
  <li>assets: Map of assets, keyed by assets key, where each asset is versioned. <code>{&lt;asset-1-key&gt; {:current &lt;mod-time&gt; :versions {:mod-time-1 &lt;asset-v1&gt; ...}}}</code></li>
  <li>asset-key: Key into the asset map</li>
  <li>returns: The <code>:current</code> of the asset matching the given key. nil if asset not present.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L129">view source</a></div></div><div class="public anchor" id="var-delete-asset-version"><h3>delete-asset-version</h3><div class="usage"><code>(delete-asset-version versioned-asset {:keys [modified-time], :as asset})</code></div><div class="doc"><div class="markdown"><p>Same as delete version execpt it is given the version to be deleted rather than just  the version number (modified-time).</p>
<p>If the version is the current one, then current becomes on the remaining versions.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1-data&gt;}}}</code></li>
  <li>asset: Asset to be removed. Must include a <code>:modified-time</code> key, to identify the version to be deleted.</li>
  <li>returns: updated versioned-asset, with version removed and <code>:current</code> updated if the current was deleted.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L323">view source</a></div></div><div class="public anchor" id="var-delete-version"><h3>delete-version</h3><div class="usage"><code>(delete-version {:keys [current versions], :as versioned-asset} version)</code></div><div class="doc"><div class="markdown"><p>Removes the specified version from the versioned asset. Ensures at least one asset version remains, (i.e, you cannot delete the last version) and that if the  deleted asset is current a new asset (first) is selected as current.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>version: The version to be removed, typically the modified time.</li>
  <li>returns: updated versioned-asset.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L307">view source</a></div></div><div class="public anchor" id="var-find-element-with-ref-name"><h3>find-element-with-ref-name</h3><div class="usage"><code>(find-element-with-ref-name vec ref-key name)</code></div><div class="doc"><div class="markdown"><p>Search’s a vector for the first element that has a version reference matching the given name.</p>
<p>Uses ref-key to determine which item in the element map is the version reference, then matches name against the first item of this reference.</p>
<p>Useful when searching for references to a versioned asset.</p>
<ul>
  <li>vec: Vector of elements. <code>[ {&lt;ref-key&gt; [&lt;asset-name&gt; &lt;asset-version] ...}, ...]</code></li>
  <li>ref-key: The key within each element in the vector that contains the version reference of the form <code>[&lt;asset-key&gt; &lt;version&gt;]</code></li>
  <li>name: The asset key to be matched.</li>
  <li>returns: The full element from vec which has a reference with that name.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L71">view source</a></div></div><div class="public anchor" id="var-find-index"><h3>find-index</h3><div class="usage"><code>(find-index versioned-asset {:keys [modified-time], :as element})</code></div><div class="doc"><div class="markdown"><p>Treats the versions within the versioned-assets as a vector of version modification times, from smallest to highest, and returns the index within that vector of the provided elements modified time.</p>
<ul>
  <li>versioned-asset: Versioned asset to be searched for versions. <code>{:versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>element: Uses the <code>:modified-time</code> attribute as the value to find the index of.</li>
  <li>returns index or nil if not found.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L114">view source</a></div></div><div class="public anchor" id="var-get-current"><h3>get-current</h3><div class="usage"><code>(get-current assets asset-key)</code></div><div class="doc"><div class="markdown"><p>Gets the current version of the asset with the given key.</p>
<ul>
  <li>assets: Maps of assets, keyed by asset key, where each asset is versioned. <code>{&lt;asset-1-key&gt; {:current &lt;mod-time&gt; :versions {:mod-time-1 &lt;asset-v1&gt; ...}}}</code></li>
  <li>asset-key: Key of the asset for which the current version required.</li>
  <li>returns: The current version of the asset.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L175">view source</a></div></div><div class="public anchor" id="var-get-current-asset"><h3>get-current-asset</h3><div class="usage"><code>(get-current-asset {:keys [current versions], :as versioned-asset})</code></div><div class="doc"><div class="markdown"><p>Gets the current version of the given versioned asset.</p>
<ul>
  <li>versioned-asset: Versioned asset to be searched for versions. <code>{:current &lt;mod-time&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>returns: The current version of the asset.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L187">view source</a></div></div><div class="public anchor" id="var-get-current-ref"><h3>get-current-ref</h3><div class="usage"><code>(get-current-ref assets asset-key)</code></div><div class="doc"><div class="markdown"><p>Build an asset reference [name version] for the named asset using the current version</p>
<ul>
  <li>assets: Maps of assets, keyed by assets key, where each asset is versioned. <code>{&lt;asset-1-key&gt; {:current &lt;mod-time&gt; :versions {:mod-time-1 &lt;asset-v1&gt; ...}}}</code></li>
  <li>asset-key: Key into the asset map</li>
  <li>returns: A reference to the current version of the asset. Format is <code>[asset-key version]</code>. version is usually modified time.  if asset not in assets, reference will have nil as the version.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L140">view source</a></div></div><div class="public anchor" id="var-get-first-asset-ref"><h3>get-first-asset-ref</h3><div class="usage"><code>(get-first-asset-ref assets)</code></div><div class="doc"><div class="markdown"><p>Access the first asset in the asset map and then extracts the reference to the current version  for that asset</p>
<ul>
  <li>assets: Maps of assets, keyed by assets key, where each asset is versioned. <code>{&lt;asset-1-key&gt; {:current &lt;mod-time&gt; :versions {:mod-time-1 &lt;asset-v1&gt; ...}}}</code></li>
  <li>returns: A reference to the current version of the first asset. Format is <code>[asset-key version]</code>. version is usually modified time.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L152">view source</a></div></div><div class="public anchor" id="var-get-ordered-versions"><h3>get-ordered-versions</h3><div class="usage"><code>(get-ordered-versions {:keys [versions], :as versioned-asset})</code></div><div class="doc"><div class="markdown"><p>Extracts an ordered list of versions (from least to highest modified time) from the versioned-asset.</p>
<ul>
  <li>versioned-asset: Versioned asset to be searched for versions. <code>{:versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>returns: vector of versions (from smallest to highest) <code>[&lt;asset-1&gt; ...]</code>]</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L104">view source</a></div></div><div class="public anchor" id="var-get-version"><h3>get-version</h3><div class="usage"><code>(get-version assets [asset-key version])</code></div><div class="doc"><div class="markdown"><p>Gets the specified version of the named asset</p>
<ul>
  <li>assets: Maps of assets, keyed by assets key, where each asset is versioned. <code>{&lt;asset-1-key&gt; {:current &lt;mod-time&gt; :versions {:mod-time-1 &lt;asset-v1&gt; ...}}}</code></li>
  <li>reference: Vector of the asset-key (or name) and the required version (usually modified-time). <code>[asset-key version]</code></li>
  <li>returns: the asset with the required key and version.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L164">view source</a></div></div><div class="public anchor" id="var-make-ref-name-fn"><h3>make-ref-name-fn</h3><div class="usage"><code>(make-ref-name-fn ref-key name)</code></div><div class="doc"><div class="markdown"><p>Makes a function that will test an element with a reference key item against the name (where name will match the first item of the ref-key value, i.e. the asset-key)</p>
<ul>
  <li>ref-key: The key in the element that contains the reference.</li>
  <li>name: The value of the name part (or asset-key) of the reference that the returned function will check</li>
  <li>returns: <code>fn(element)</code> where element should have a key of ref-key that is a reference <code>[asset-key version]</code> and the function will return true if the reference asset-key equals “name”</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L60">view source</a></div></div><div class="public anchor" id="var-mutate-version"><h3>mutate-version</h3><div class="usage"><code>(mutate-version mutation versioned-asset asset)</code></div><div class="doc"><div class="markdown"><p>Updates the version by either replacing the current or adding a new version. The action taken depends on whether the current one has the same mutation as passed in. If the same we dont bother creating a new version and just replace current.</p>
<ul>
  <li>mutation: The data to be added to the asset using the <code>:mutation</code> key.</li>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>asset: asset data to have mutation added.</li>
  <li>returns: updated versioned-asset with the mutated asset added as a new and latest version, or if the current assest has the same mutation,  just replaced the current version with the new asset data.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L287">view source</a></div></div><div class="public anchor" id="var-remove-unused-versions"><h3>remove-unused-versions</h3><div class="usage"><code>(remove-unused-versions versioned-asset)</code><code>(remove-unused-versions {:keys [current versions], :as versioned-asset} pred-fn)</code></div><div class="doc"><div class="markdown"><p>Removes any unused versions. A used version is either current or marked as starred (has a <code>:starred</code> true attribute) or returns true to the optional given predicate function.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-1&gt; :versions {&lt;mod-key-1 {:starred &lt;bool&gt; &lt;asset-1-data&gt;}}}</code></li>
  <li>pred-fn: optional last argument should accept the version and return true if used. Defaults to a function that is always false</li>
  <li>returns: versioned-asset with unused versions removed.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L338">view source</a></div></div><div class="public anchor" id="var-rename-versioned-asset"><h3>rename-versioned-asset</h3><div class="usage"><code>(rename-versioned-asset {:keys [versions], :as versioned-asset} new-name)</code></div><div class="doc"><div class="markdown"><p>Will change the top level name of the asset and change the name in all the versions of the asset.</p>
<ul>
  <li>versioned-asset: Versioned asset to be searched for versions. <code>{:current &lt;mod-time&gt; :name &lt;asset-key&gt; :versions {&lt;mod-key-1&gt; {:name &lt;asset-key&gt; ...}, &lt;mod-key-2&gt; {..} ...}}</code></li>
  <li>new-name: New name to use for the asset, and hence for each version.</li>
  <li>returns: updated versioned-asset map where the top level name and the name in the versions are modified to the new name.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L207">view source</a></div></div><div class="public anchor" id="var-rename-versions"><h3>rename-versions</h3><div class="usage"><code>(rename-versions versions new-name)</code></div><div class="doc"><div class="markdown"><p>Renames element in the versions map, modifying the <code>:name</code> attribute to the new name.</p>
<ul>
  <li>versions: Versions map, each entry to have name updated. <code>{&lt;mod-key-1&gt; {:name &lt;asset-key&gt; ...}, &lt;mod-key-2&gt; {..} ...}</code></li>
  <li>new-name: New name to use for the asset, and hence for each version.</li>
  <li>returns: updated version map where the name in the versions are modified to the new name.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L197">view source</a></div></div><div class="public anchor" id="var-replace-current"><h3>replace-current</h3><div class="usage"><code>(replace-current {:keys [current], :as versioned-asset} asset)</code></div><div class="doc"><div class="markdown"><p>Replaces the current version with the supplied version, but does not change any version number.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>asset: New asset to replace the existing current.</li>
  <li>returns: Updated versioned-asset.</li>
</ul>
<p>Should be used only when updates are to be made to the current version which you don’t want to affect versioning.</p></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L263">view source</a></div></div><div class="public anchor" id="var-replace-element-with-ref-name"><h3>replace-element-with-ref-name</h3><div class="usage"><code>(replace-element-with-ref-name vec replacement-element ref-key name)</code></div><div class="doc"><div class="markdown"><p>Searches a vector of elements where each element holds a reference <code>[name, version]</code>. It will search for the element that references the given name, and replace it with the supplied replacement element.</p>
<ul>
  <li>vec: Vector of elements to search. <code>[ {&lt;ref-key&gt; [name, version] ...}, ...]</code></li>
  <li>replacement-element: New element to replace the matching element.</li>
  <li>ref-key: The key in the element that holds the reference <code>[name/asset-key, version]</code></li>
  <li>name: The name/asset-key in the reference that is being searched for.</li>
  <li>returns: New vector with the suitable replacement element.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L89">view source</a></div></div><div class="public anchor" id="var-set-version"><h3>set-version</h3><div class="usage"><code>(set-version versioned-asset asset)</code></div><div class="doc"><div class="markdown"><p>Sets the current version to the <code>:modified-time</code> of the given asset. Assumes this exists already as a version.</p>
<ul>
  <li>versioned-asset: Existing versioned asset, with map of current versions. <code>{:current &lt;mod-key&gt; :versions {&lt;mod-key-1&gt; {&lt;asset-1&gt;}}}</code></li>
  <li>asset: New asset to whose modified-time is to become the current version.</li>
  <li>returns: Updated versioned-asset.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L276">view source</a></div></div><div class="public anchor" id="var-timestamp-element"><h3>timestamp-element</h3><div class="usage"><code>(timestamp-element element)</code><code>(timestamp-element element force)</code></div><div class="doc"><div class="markdown"><p>Marks the element with the appropriate modification time.</p>
<ul>
  <li>element: Map in which a new <code>:modified-time</code> keyword to be added, if required.</li>
  <li>force: optional 2 arity argument. If true will update <code>:modified-time</code> even if it exists. false by default.</li>
  <li>returns: map with <code>:modified-time</code> set to current time in millis if not set or force = true.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L219">view source</a></div></div><div class="public anchor" id="var-version-element"><h3>version-element</h3><div class="usage"><code>(version-element element)</code></div><div class="doc"><div class="markdown"><p>Prepare a new element for versioning. Will ensure timestamped and also not starred (as is new version)</p>
<ul>
  <li>element: Map which represent the version of an asset to be placed into list of versions.</li>
  <li>returns: same element, but with appropriate <code>:modified-time</code> and no <code>:starred</code> attribute.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/nicheware/cljc-common/blob/master/src/cljc/nicheware/platform/utilities/common/version.cljc#L233">view source</a></div></div></div></body></html>